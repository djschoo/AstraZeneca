---
title: "Does the AstraZeneca Vaccine Cause Blood Clots?"
author: "djschoo"
date: "31/03/2021"
output: rmdformats::readthedown
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

Health Canada recently made the...interesting...decision to suspend the AstraZeneca Covidshield vaccine the other day due to fears that this vaccine causes blood clots. From [this article on CBC](https://www.cbc.ca/news/health/canada-suspends-astrazeneca-vaccine-covid-19-1.5968657), "the decision to halt the use of the vaccine in Canadians under 55 comes after the European Medicines Agency (EMA) investigated 25 cases of the rare blood clots out of about 20 million AstraZeneca shots given."

I was immediately surprised when I heard this. 25 out of 20 million seems *very* small, even if the likelihood of any individual out there getting a blood clot is itself also small. In other words, aren't those unfortunate 25 cases of clots due to random chance that would have happened anyway?

This can be modeled statistically. (Health Canada uses statistics, right?) Let's investigate!

# Binomial Distribution

I believe that this issue of blood clotting can be modeled with a simple binomial distribution. Recall that the binomial distribution models the discrete probability distribution of the number of successes in a sequence of independent experiments, each asking a yesâ€“no question, and each with its own Boolean-valued outcome. 

In other words, each person every day essentially "flips a coin" (albeit a *very* biased one) as to whether they will get a blood clot that day. (In the morbid language of statistics, we will call each clot a "success"). 

If we make a few reasonable assumptions (for example, that everyone has the same probability of getting a "success") the binomial distribution can tell us the probability of observing each potential number of clots.

# Blood Clots 

I duckduckwent "what is the probability of a blood clot?" and got [this website](https://www.stoptheclot.org/blood-clot-information/blood-clots-in-the-united-states/) as the first hit. The article states that "107 to 130 cases of potentially deadly blood clots occurred each year per 100,000 Caucasian individuals from 1985 through 2002. This translates into about 1 to 3 cases per 1,000 people."

I will be conservative and assume that the probability of a clot per year is $1/1000$. Assuming an even spread of clots throughout the year, the probability of a clot per day is $\frac{1/1000}{365}$. Note that this is also a conservative estimate because presumably the 25 clots following AstraZeneca were in a number of days following the vaccine and so the true probability is higher.

# Parameters

We now have enough parameters to run our model. These are:

- The probability of a blood clot: $p = \frac{1/1000}{365}$
- The number of "successes" we would like to know the probability of seeing: $x = 25$
- The total number of trials: $n = 20*10^6$

```{r}
p = 1/(1000*365)
x = 25
n = 20*10^6
```


# The Model

## Expected Value of the Binomial Distribution

Before we calculate the probability of observing our data, note that expected value of the binomial distribution is equal to $np$. In our case, this equals $20*10^6 * \frac{1/1000}{365} \approx 55$. 

That means that *if we give out sugar pills to 20 million people, we would expect around 55 of them to get a blood clot* anyway.

## Probability Distribution

We can elaborate on the previous point with a picture. The following shows the probability (y-axis) of seeing various numbers of blood clots (x-axis) centered around our expected value. I threw in a verticle line in purple at 25 clots.

```{r, warning=F, message=F}
library(ggplot2)

X = 0:(55*2)
Y = dbinom(X, n, p)
df = data.frame(X,Y)

ggplot(df) + 
  aes(x=X, y=Y) + 
  geom_line() + 
  labs(y="probability", x="# of clots") + 
  geom_vline(aes(xintercept=25, color='purple')) + 
  guides(color='none')
```

We can see that the probability is centered around the expected value of 55 clots and tapers off such that the probability approaches zero outside the range of around 30 to 80 clots.

In other words, 25 clots is less than even the minimum number of clots that are remotely likely to happen.

## Probability of Exactly 25 People Getting Clots

The visual inspection of the graph above makes it plainly obvious that the probability of seeing exactly 25 clots (or fewer) will (effectively) be zero. But let's prove it nonetheless:

```{r}
dbinom(x, n, p)
```

That is 0.0003%; ergo effectively zero. Much like it is technically possible to flip a coin 100 times and get heads each time (the probability of that is $7.888609 * 10^{-31}$, by the way) it is also technically possible to get a mere 25 clots. It is just **incredibly** unlikely.

# Conclusion

**There is no evidence suggesting that AstraZeneca causes blood clots! If anything, it prevents them!**

If you take 20 million people with or without AstraZeneca, around 55 of them should get a blood clot. If it's a particularly rare un-clotty day, you **might** expect to see about 30 clots. 25 is so low that it's next to impossible!

I have no clue if AZ or the other vaccines are safe in the long term (nobody does). But so far so good, and one thing we **do** know is that getting Covid is horrible, as is transmitting Sars-Cov-2, so it seems pretty obvious to me that it's worth getting a vaccine. 

Unless I am missing something, the decision to cancel AZ due to fear of blood clots is crazy. Stoking hysteria in the public is a bad thing in general and each day that passes is a chance to potentially vaccinate people against a brutal virus.